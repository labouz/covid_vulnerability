import pandas as p

df = p.read_csv('../data/COVID-19_Reported_Patient_Impact_and_Hospital_Capacity_by_State_Timeseries.csv')

a = df.columns

deletes = ['icu_patients_confirmed_influenza',
'icu_patients_confirmed_influenza_coverage',
'previous_day_admission_influenza_confirmed',
'previous_day_admission_influenza_confirmed_coverage',
'previous_day_deaths_covid_and_influenza',
'previous_day_deaths_covid_and_influenza_coverage',
'previous_day_deaths_influenza',
'previous_day_deaths_influenza_coverage',
'total_patients_hospitalized_confirmed_influenza',
'total_patients_hospitalized_confirmed_influenza_and_covid',
'total_patients_hospitalized_confirmed_influenza_and_covid_coverage',
'total_patients_hospitalized_confirmed_influenza_coverage',
'previous_day_admission_adult_covid_confirmed_18-19',
'previous_day_admission_adult_covid_confirmed_18-19_coverage',
'previous_day_admission_adult_covid_confirmed_20-29',
'previous_day_admission_adult_covid_confirmed_20-29_coverage',
'previous_day_admission_adult_covid_confirmed_30-39',
'previous_day_admission_adult_covid_confirmed_30-39_coverage',
'previous_day_admission_adult_covid_confirmed_40-49',
'previous_day_admission_adult_covid_confirmed_40-49_coverage',
'previous_day_admission_adult_covid_confirmed_50-59',
'previous_day_admission_adult_covid_confirmed_50-59_coverage',
'previous_day_admission_adult_covid_confirmed_60-69',
'previous_day_admission_adult_covid_confirmed_60-69_coverage',
'previous_day_admission_adult_covid_confirmed_70-79',
'previous_day_admission_adult_covid_confirmed_70-79_coverage',
'previous_day_admission_adult_covid_confirmed_80+',
'previous_day_admission_adult_covid_confirmed_80+_coverage',
'previous_day_admission_adult_covid_confirmed_unknown',
'previous_day_admission_adult_covid_confirmed_unknown_coverage',
'previous_day_admission_adult_covid_suspected_18-19',
'previous_day_admission_adult_covid_suspected_18-19_coverage',
'previous_day_admission_adult_covid_suspected_20-29',
'previous_day_admission_adult_covid_suspected_20-29_coverage',
'previous_day_admission_adult_covid_suspected_30-39',
'previous_day_admission_adult_covid_suspected_30-39_coverage',
'previous_day_admission_adult_covid_suspected_40-49',
'previous_day_admission_adult_covid_suspected_40-49_coverage',
'previous_day_admission_adult_covid_suspected_50-59',
'previous_day_admission_adult_covid_suspected_50-59_coverage',
'previous_day_admission_adult_covid_suspected_60-69',
'previous_day_admission_adult_covid_suspected_60-69_coverage',
'previous_day_admission_adult_covid_suspected_70-79',
'previous_day_admission_adult_covid_suspected_70-79_coverage',
'previous_day_admission_adult_covid_suspected_80+',
'previous_day_admission_adult_covid_suspected_80+_coverage',
'previous_day_admission_adult_covid_suspected_unknown',
'previous_day_admission_adult_covid_suspected_unknown_coverage',
'adult_icu_bed_utilization_numerator',
'adult_icu_bed_utilization_denominator',
'inpatient_bed_covid_utilization_numerator',
'inpatient_bed_covid_utilization_denominator',
'percent_of_inpatients_with_covid_numerator',
'percent_of_inpatients_with_covid_denominator',
'inpatient_beds_utilization_numerator',
'inpatient_beds_utilization_denominator',
'staffed_adult_icu_bed_occupancy_coverage',
'staffed_icu_adult_patients_confirmed_and_suspected_covid',
'staffed_icu_adult_patients_confirmed_and_suspected_covid_coverage',
'staffed_icu_adult_patients_confirmed_covid',
'staffed_icu_adult_patients_confirmed_covid_coverage',
'total_adult_patients_hospitalized_confirmed_and_suspected_covid',
'total_adult_patients_hospitalized_confirmed_and_suspected_covid_coverage',
'total_adult_patients_hospitalized_confirmed_covid',
'total_adult_patients_hospitalized_confirmed_covid_coverage',
'total_pediatric_patients_hospitalized_confirmed_and_suspected_covid',
'total_pediatric_patients_hospitalized_confirmed_and_suspected_covid_coverage',
'total_pediatric_patients_hospitalized_confirmed_covid',
'total_pediatric_patients_hospitalized_confirmed_covid_coverage',
'on_hand_supply_therapeutic_a_casirivimab_imdevimab_courses',
'on_hand_supply_therapeutic_b_bamlanivimab_courses',
'on_hand_supply_therapeutic_c_bamlanivimab_etesevimab_courses',
'previous_week_therapeutic_a_casirivimab_imdevimab_courses_used',
'previous_week_therapeutic_b_bamlanivimab_courses_used',
'previous_week_therapeutic_c_bamlanivimab_etesevimab_courses_used',
'previous_day_admission_adult_covid_suspected',
'previous_day_admission_adult_covid_suspected_coverage',
'previous_day_admission_pediatric_covid_suspected',
'previous_day_admission_pediatric_covid_suspected_coverage',
'adult_icu_bed_covid_utilization_numerator',
'adult_icu_bed_covid_utilization_denominator',
'geocoded_state'
]

for i in deletes:
    df = df.drop(i, axis=1)


Nas = []
for i in df.columns:
    nas = {i:df[i].isna().sum()}
    Nas.append(nas)
    

c = df.columns



df['date'] = p.to_datetime(df['date'])

df = df.sort_values(["state", "date"])


test = df.fillna(method='ffill')


test.reset_index()


lists = []
for i in sorted(set(test['state'])):
    u = df[df.state == i]
    u = u.fillna(method='ffill')
    u = u.fillna(0)
    lists.append(u)
    del u


    

