###############################################################################
# Make hospital burden variable
# Author: Group 1
# Date: 2022-02-28
# Description: This script creates a hospital burden variable - the outcome of our time-series analysis.
#################################################################################

# import libraries
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import warnings
import datetime
warnings.filterwarnings('ignore') 

# load CSV into df -will need to decide cutoff date
hosp_df = pd.read_csv("./data/COVID-19_Reported_Patient_Impact_and_Hospital_Capacity_by_State_Timeseries.csv")

### create new indicator variable based on adult_icu_bed_utilization ----------------
# based on threshold of 0.8 (https://www.cdc.gov/mmwr/volumes/70/wr/mm7046a5.htm)
# convert utilization to float
hosp_df['adult_icu_bed_utilization'] = hosp_df['adult_icu_bed_utilization'].astype(float)
# create new indicator variable
hosp_df['isBurden'] = np.where(hosp_df['adult_icu_bed_utilization'] > 0.8, 1, 0)
# convert date to date
hosp_df['date']= pd.to_datetime(hosp_df['date'])
