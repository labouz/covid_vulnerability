###############################################################################
# Make hospital burden variable
# Author: Group 1
# Date: 2022-02-28
# Description: This script creates a hospital burden variable - the outcome of our time-series analysis.
#################################################################################

# import libraries
import pandas as pd
import numpy as np
from sodapy import Socrata 

# import json data via API
client = Socrata("healthdata.gov", None)
results = client.get("g62h-syeh")
hosp_df = pd.DataFrame.from_records(results)

### create new indicator variable based on adult_icu_bed_utilization ----------------
# based on threshold of 0.8 (https://www.cdc.gov/mmwr/volumes/70/wr/mm7046a5.htm)
# convert utilization to float
hosp_df['adult_icu_bed_utilization'] = hosp_df['adult_icu_bed_utilization'].astype(float)
# create new indicator variable
hosp_df['isBurden'] = np.where(hosp_df['adult_icu_bed_utilization'] > 0.8, 1, 0)
