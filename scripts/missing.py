###############################################################################
# Make function to handle missing data
# Author: Group 1
# Date: 2022-03-05
# Description: This script creates a function that takes in a variable and returns a dataframe with missing data imputed.
#################################################################################

# import libraries
import pandas as pd
import numpy as np

# create function to handle missing data
# this function will impute missing data based on the data of the same variable in the previous row
# it will use the first non-missing value in the previous row
# I: dataframe, vector of variables
# O: dataframe with missing data imputed
def impute-missing(df, vars):
    for var in vars:
        # create new column for imputed data
        df[var+'_imputed'] = np.nan
        # loop through dataframe
        for i in range(1, len(df)):
            # if the current value is missing
            if np.isnan(df[var][i]):
                # if the previous value is missing
                if np.isnan(df[var][i-1]):
                    # impute the value as the first non-missing value
                    df[var+'_imputed'][i] = df[var][i-1]
                # if the previous value is not missing
                else:
                    # impute the value as the previous value
                    df[var+'_imputed'][i] = df[var][i-1]
            # if the current value is not missing
            else:
                # impute the value as the current value
                df[var+'_imputed'][i] = df[var][i]
        # drop the original column
        df = df.drop(var, axis=1)
    return df

# Test function

# load CSV into df -will need to decide cutoff date
hosp_df = pd.read_csv("./data/COVID-19_Reported_Patient_Impact_and_Hospital_Capacity_by_State_Timeseries.csv")

